# Integration SPARQL Queries - Consolidated file for all integration domain queries
# Each query is separated by a comment block for easy identification

#### PLAYER_TEAM_COACH_NETWORK ####
PREFIX : <http://www.semanticweb.org/sports/ontology#>
PREFIX data: <http://www.semanticweb.org/sports/data#>
SELECT ?playerName ?teamName ?coachName ?marketValue
WHERE {
    ?player a :Player ;
            :hasName ?playerName ;
            :playsFor ?team .
    # Restrict to only H2 database individuals (not ABox individuals)
    FILTER(STRSTARTS(STR(?player), "http://www.semanticweb.org/sports/data#"))
    
    ?team a :Team ;
          :hasName ?teamName ;
          :hasCoach ?coach .
    
    ?coach a :Coach ;
           :hasName ?coachName .
    
    OPTIONAL {
        ?player :hasMarketValue ?marketValue .
    }
}
ORDER BY ?teamName ?playerName

#### TEAM_SQUAD_ANALYSIS ####
PREFIX : <http://www.semanticweb.org/sports/ontology#>
PREFIX data: <http://www.semanticweb.org/sports/data#>
SELECT ?teamName (COUNT(?player) AS ?squadSize) (AVG(?age) AS ?avgAge)
WHERE {
    ?team a :Team ;
          :hasName ?teamName ;
          :hasPlayer ?player .
    # Restrict to only H2 database individuals (not ABox individuals)
    FILTER(STRSTARTS(STR(?player), "http://www.semanticweb.org/sports/data#"))
    
    ?player :hasAge ?age .
}
GROUP BY ?teamName
ORDER BY DESC(?squadSize)

#### CONTRACT_OVERVIEW ####
PREFIX : <http://www.semanticweb.org/sports/ontology#>
PREFIX data: <http://www.semanticweb.org/sports/data#>
SELECT ?personName ?teamName ?contractType ?salary
WHERE {
    ?person a :Person ;
            :hasName ?personName ;
            :hasContract ?contract .
    # Restrict to only H2 database individuals (not ABox individuals)
    FILTER(STRSTARTS(STR(?person), "http://www.semanticweb.org/sports/data#"))
    
    ?contract a :Contract ;
              :contractWith ?team ;
              :hasSalary ?salary .
    
    ?team :hasName ?teamName .
    
    OPTIONAL {
        ?person a ?personType .
        FILTER(?personType IN (:Player, :Coach))
        BIND(IF(?personType = :Player, "Player Contract", "Coach Contract") AS ?contractType)
    }
}
ORDER BY ?teamName ?personName

#### AVERAGE_MARKET_VALUE_BY_TEAM ####
PREFIX : <http://www.semanticweb.org/sports/ontology#>
PREFIX data: <http://www.semanticweb.org/sports/data#>
SELECT ?teamName (AVG(?marketValue) AS ?avgMarketValue) (COUNT(?player) AS ?playerCount) (MAX(?marketValue) AS ?highestValuePlayer) ?stadiumCapacity
WHERE {
    ?team a :Team ;
          :hasName ?teamName ;
          :hasPlayer ?player ;
          :hasStadiumCapacity ?stadiumCapacity .
    
    ?player a :Player ;
            :hasMarketValue ?marketValue .
    # Restrict to only H2 database individuals (not ABox individuals)
    FILTER(STRSTARTS(STR(?player), "http://www.semanticweb.org/sports/data#"))
    
    FILTER(?marketValue > 0)
}
GROUP BY ?teamName ?stadiumCapacity
HAVING (COUNT(?player) > 1)
ORDER BY DESC(?avgMarketValue)

############################ NEW EXTRA QUERIES ############################
# These queries provide rich, visual results for better exploration in Protégé

#### PLAYER_PROFILES_WITH_ALL_DETAILS ####
PREFIX : <http://www.semanticweb.org/sports/ontology#>
PREFIX data: <http://www.semanticweb.org/sports/data#>
SELECT ?playerName ?age ?marketValue ?position ?nationality ?teamName
WHERE {
    ?player a :Player ;
            :hasPlayerName ?playerName ;
            :hasAge ?age ;
            :hasMarketValue ?marketValue ;
            :hasNationality ?nationality .
    
    OPTIONAL { ?player :playsPosition ?pos . ?pos :hasPositionName ?position }
    OPTIONAL { ?player :playsForTeam ?team . ?team :hasTeamName ?teamName }
    
    FILTER(STRSTARTS(STR(?player), "http://www.semanticweb.org/sports/data#"))
}
ORDER BY DESC(?marketValue)

#### TEAM_FINANCIAL_OVERVIEW ####
PREFIX : <http://www.semanticweb.org/sports/ontology#>
PREFIX data: <http://www.semanticweb.org/sports/data#>
SELECT ?teamName (SUM(?value) AS ?totalSquadValue) (AVG(?value) AS ?avgPlayerValue) (COUNT(?player) AS ?squadSize)
WHERE {
    ?team a :Team ;
          :hasTeamName ?teamName .
    
    ?player a :Player ;
            :playsForTeam ?team ;
            :hasMarketValue ?value .
    
    FILTER(STRSTARTS(STR(?player), "http://www.semanticweb.org/sports/data#"))
    FILTER(STRSTARTS(STR(?team), "http://www.semanticweb.org/sports/data#"))
}
GROUP BY ?teamName
ORDER BY DESC(?totalSquadValue)

#### NATIONALITY_DISTRIBUTION ####
PREFIX : <http://www.semanticweb.org/sports/ontology#>
PREFIX data: <http://www.semanticweb.org/sports/data#>
SELECT ?nationality (COUNT(?player) AS ?playerCount) (AVG(?marketValue) AS ?avgValue)
WHERE {
    ?player a :Player ;
            :hasNationality ?nationality ;
            :hasMarketValue ?marketValue .
    
    FILTER(STRSTARTS(STR(?player), "http://www.semanticweb.org/sports/data#"))
}
GROUP BY ?nationality
ORDER BY DESC(?playerCount)

#### YOUNG_VS_EXPERIENCED_PLAYERS ####
PREFIX : <http://www.semanticweb.org/sports/ontology#>
PREFIX data: <http://www.semanticweb.org/sports/data#>
SELECT ?playerName ?age ?marketValue 
       (IF(?age < 25, "Young", IF(?age > 30, "Veteran", "Prime")) AS ?category)
WHERE {
    ?player a :Player ;
            :hasPlayerName ?playerName ;
            :hasAge ?age ;
            :hasMarketValue ?marketValue .
    
    FILTER(STRSTARTS(STR(?player), "http://www.semanticweb.org/sports/data#"))
}
ORDER BY ?age

#### TOP_VALUE_PLAYERS_BY_POSITION ####
PREFIX : <http://www.semanticweb.org/sports/ontology#>  
PREFIX data: <http://www.semanticweb.org/sports/data#>
SELECT ?positionName ?playerName ?marketValue ?age
WHERE {
    ?player a :Player ;
            :hasPlayerName ?playerName ;
            :hasMarketValue ?marketValue ;
            :hasAge ?age ;
            :playsPosition ?position .
    
    ?position :hasPositionName ?positionName .
    
    FILTER(STRSTARTS(STR(?player), "http://www.semanticweb.org/sports/data#"))
}
ORDER BY ?positionName DESC(?marketValue)

#### MARKET_VALUE_TIERS ####
PREFIX : <http://www.semanticweb.org/sports/ontology#>
PREFIX data: <http://www.semanticweb.org/sports/data#>
SELECT ?playerName ?marketValue 
       (IF(?marketValue >= 100000000, "Elite (100M+)", 
           IF(?marketValue >= 50000000, "Star (50-100M)",
              IF(?marketValue >= 20000000, "Starter (20-50M)", "Squad (Under 20M)"))) AS ?tier)
WHERE {
    ?player a :Player ;
            :hasPlayerName ?playerName ;
            :hasMarketValue ?marketValue .
    
    FILTER(STRSTARTS(STR(?player), "http://www.semanticweb.org/sports/data#"))
}
ORDER BY DESC(?marketValue)

