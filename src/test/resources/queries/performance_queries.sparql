# Performance SPARQL Queries - Consolidated file for all performance domain queries
# Each query is separated by a comment block for easy identification

#### SIMPLE_PLAYER_COUNT ####
PREFIX : <http://www.semanticweb.org/sports/ontology#>
PREFIX data: <http://www.semanticweb.org/sports/data#>
SELECT (COUNT(?player) AS ?playerCount)
WHERE {
    ?player a :Player .
    # Restrict to only H2 database individuals (not ABox individuals)
    FILTER(STRSTARTS(STR(?player), "http://www.semanticweb.org/sports/data#"))
}

#### COMPLEX_AGGREGATION_TEST ####
PREFIX : <http://www.semanticweb.org/sports/ontology#>
PREFIX data: <http://www.semanticweb.org/sports/data#>
SELECT ?teamName (COUNT(?player) AS ?playerCount)
WHERE {
    ?team a :Team ;
          :hasName ?teamName ;
          :hasPlayer ?player .
    
    # Restrict to only H2 database individuals (not ABox individuals)
    FILTER(STRSTARTS(STR(?team), "http://www.semanticweb.org/sports/data#"))
    FILTER(STRSTARTS(STR(?player), "http://www.semanticweb.org/sports/data#"))
}
GROUP BY ?teamName
ORDER BY DESC(?playerCount)



#### COMPLEX_TEAM_STATISTICS ####
PREFIX : <http://www.semanticweb.org/sports/ontology#>
PREFIX data: <http://www.semanticweb.org/sports/data#>
SELECT ?teamName (COUNT(?player) AS ?playerCount)
WHERE {
    ?team a :Team ;
          :hasName ?teamName ;
          :hasPlayer ?player .
    
    # Restrict to only H2 database individuals (not ABox individuals)
    FILTER(STRSTARTS(STR(?team), "http://www.semanticweb.org/sports/data#"))
    FILTER(STRSTARTS(STR(?player), "http://www.semanticweb.org/sports/data#"))
}
GROUP BY ?teamName
ORDER BY DESC(?playerCount)



#### AGE_PERFORMANCE_CORRELATION ####
PREFIX : <http://www.semanticweb.org/sports/ontology#>
PREFIX data: <http://www.semanticweb.org/sports/data#>
SELECT ?ageGroup (COUNT(?player) AS ?playerCount) (AVG(?marketValue) AS ?avgValue) (MAX(?marketValue) AS ?maxValue)
WHERE {
    ?player a :Player ;
            :hasAge ?age ;
            :hasMarketValue ?marketValue .
    
    BIND(
        IF(?age < 22, "Youth (Under 22)",
           IF(?age < 26, "Prime (22-25)",
              IF(?age < 30, "Peak (26-29)", "Veteran (30+)"))) AS ?ageGroup
    )
    
    FILTER(STRSTARTS(STR(?player), "http://www.semanticweb.org/sports/data#"))
}
GROUP BY ?ageGroup
ORDER BY ?ageGroup


